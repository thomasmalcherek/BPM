<?xml version="1.0" encoding="UTF-8"?>
<bpws:process exitOnStandardFault="no" name="ArrayMappingProcess"
    suppressJoinFailure="yes" tibex:bxVersion="1.15.0"
    tibex:explicitCompensation="yes"
    tibex:xpdlId="_XUvmIAQvEem_G-97Kp4DSg"
    xmlns:bpws="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
    xmlns:jms="http://www.tibco.com/namespaces/ws/2004/soap/binding/JMS"
    xmlns:ns="http://com.tibco.poc.test.bw.saveDataCase"
    xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/"
    xmlns:tibex="http://www.tibco.com/bpel/2007/extensions"
    xmlns:tns="http://com.tibco.poc.test.bw.saveDataCase"
    xmlns:tns0="http://com.tibco.poc.test.bw.saveDataCaseXSD"
    xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <tibex:VariableDescriptor type="PersistentBatching">
        <task name="_BX_sequence_2">
            <startingVariables>
                <variable>GS</variable>
            </startingVariables>
        </task>
        <task name="Eingabe">
            <startingVariables>
                <variable>GS</variable>
            </startingVariables>
        </task>
        <task name="Ausgabe">
            <startingVariables>
                <variable>GS_FOUND_BOM</variable>
            </startingVariables>
        </task>
        <task name="_BX_sequence_4">
            <startingVariables>
                <variable>GS</variable>
            </startingVariables>
        </task>
        <task name="ScriptTask">
            <startingVariables>
                <variable>GS_FOUND_BOM</variable>
                <variable>temp_field</variable>
            </startingVariables>
        </task>
    </tibex:VariableDescriptor>
    <bpws:documentation>*** Generated by TIBCO Business Studio.</bpws:documentation>
    <bpws:import importType="http://schemas.xmlsoap.org/wsdl/"
        location="saveDataCase_JMS.wsdl" namespace="http://com.tibco.poc.test.bw.saveDataCase"/>
    <bpws:partnerLinks>
        <bpws:partnerLink name="saveDataCaseSOAP_Consumer"
            partnerLinkType="ns:saveDataCase_PLT" partnerRole="saveDataCaseProvider"/>
    </bpws:partnerLinks>
    <bpws:variables>
        <bpws:variable name="GS"
            tibex:class="com.example.arraymapping.GS"
            tibex:parameter="out" tibex:xpdlId="_NqzjgQRHEem_G-97Kp4DSg"/>
        <bpws:variable name="GS_FOUND_BOM" tibex:array="yes"
            tibex:class="com.example.arraymapping.GS" tibex:xpdlId="_bWW7QQRMEem_G-97Kp4DSg"/>
        <bpws:variable name="temp_field"
            tibex:class="saveDataCaseXSD.bw.test.poc.tibco.com.SearchDataResponsesType" tibex:xpdlId="_4EJQIQUiEem91O5jBpLYhA"/>
        <bpws:variable name="GS_FOUND_BOM_SINGLE"
            tibex:class="com.example.arraymapping.GS" tibex:xpdlId="_MDbBAQUuEem91O5jBpLYhA"/>
    </bpws:variables>
    <bpws:extensions>
        <bpws:extension mustUnderstand="yes" namespace="http://www.tibco.com/bpel/2007/extensions"/>
    </bpws:extensions>
    <bpws:eventHandlers/>
    <bpws:flow name="_BX_flow_V_54QAUuEem91O5jBpLYhA">
        <bpws:links>
            <bpws:link name="ServiceTask_2 to ScriptTask" tibex:xpdlId="_IaM4kQUjEem91O5jBpLYhA"/>
            <bpws:link name="ScriptTask to Ausgabe" tibex:xpdlId="_55MisAUhEem91O5jBpLYhA"/>
            <bpws:link name="StartEvent to Eingabe" tibex:xpdlId="_iGDoEAQ5Eem_G-97Kp4DSg"/>
            <bpws:link name="Eingabe to ServiceTask" tibex:xpdlId="_XD3yYARMEem_G-97Kp4DSg"/>
            <bpws:link name="ServiceTask to ServiceTask_2" tibex:xpdlId="_5rk9cQUhEem91O5jBpLYhA"/>
            <bpws:link name="Ausgabe to EndEvent" tibex:xpdlId="_zeF_AARGEem_G-97Kp4DSg"/>
        </bpws:links>
        <bpws:extensionActivity>
            <tibex:receiveEvent createInstance="yes" eventTimeout="0"
                name="StartEvent" tibex:type="startEvent"
                tibex:xpdlId="_ehsVBwQvEem_G-97Kp4DSg" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:sources>
                    <bpws:source linkName="StartEvent to Eingabe"/>
                </bpws:sources>
                <tibex:parameters>
                    <parameterDescription mode="Out" name="GS"/>
                </tibex:parameters>
                <tibex:eventSource>
                    <tibex:startEvent eventType="Default"/>
                </tibex:eventSource>
            </tibex:receiveEvent>
        </bpws:extensionActivity>
        <bpws:empty name="EndEvent" tibex:migrationAllowed="yes"
            tibex:type="endEvent" tibex:xpdlId="_ehsVCAQvEem_G-97Kp4DSg">
            <bpws:targets>
                <bpws:target linkName="Ausgabe to EndEvent"/>
            </bpws:targets>
        </bpws:empty>
        <bpws:scope name="ServiceTask" tibex:migrationAllowed="yes"
            tibex:type="serviceTask" tibex:xpdlId="_rp46UAQvEem_G-97Kp4DSg">
            <bpws:targets>
                <bpws:target linkName="Eingabe to ServiceTask"/>
            </bpws:targets>
            <bpws:sources>
                <bpws:source linkName="ServiceTask to ServiceTask_2"/>
            </bpws:sources>
            <bpws:variables>
                <bpws:variable messageType="ns:SearchDataRequest" name="v_6fcc709d"/>
                <bpws:variable messageType="ns:SearchDataResponse" name="v_8ce957f3"/>
            </bpws:variables>
            <bpws:sequence name="_BX_sequence">
                <bpws:scope name="_BX_ToSvcDataMapping">
                    <bpws:variables>
                        <bpws:variable
                            name="MESSAGE_GetDataPInputParameters" tibex:class="saveDataCaseXSD.bw.test.poc.tibco.com.SearchDataRequestType"/>
                    </bpws:variables>
                    <bpws:sequence name="_BX_sequence_2">
                        <bpws:extensionActivity>
                            <tibex:extActivity
                                name="_BX_DataMapperScript" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[// Create target 'GetDataPInputParameters' if it doesn't exist.
if (MESSAGE_GetDataPInputParameters == null) {
    MESSAGE_GetDataPInputParameters = saveDataCaseXSD_bw_test_poc_tibco_com_Factory.createSearchDataRequestType();
}

// Map from 'GS.ahvNummer' to 'GetDataPInputParameters.AHVNummer'
if (GS != null) {
    MESSAGE_GetDataPInputParameters.AHVNummer = GS.ahvNummer;
} else {
    MESSAGE_GetDataPInputParameters.AHVNummer = null;
}

// Map from 'GS.dokumentenArt' to 'GetDataPInputParameters.dokumentenArt'
if (GS != null) {
    MESSAGE_GetDataPInputParameters.dokumentenArt = GS.dokumentenArt;
} else {
    MESSAGE_GetDataPInputParameters.dokumentenArt = null;
}

// Map from 'GS.geschaeftsfall' to 'GetDataPInputParameters.geschaeftsfall'
if (GS != null) {
    MESSAGE_GetDataPInputParameters.geschaeftsfall = GS.geschaeftsfall;
} else {
    MESSAGE_GetDataPInputParameters.geschaeftsfall = null;
}


]]></tibex:script>
                            </tibex:extActivity>
                        </bpws:extensionActivity>
                        <bpws:assign name="_BX_assign" validate="no">
                            <bpws:copy
                                tibex:elementName="{http://com.tibco.poc.test.bw.saveDataCaseXSD}SearchDataRequest" tibex:transform="ObjectToXml">
                                <bpws:from expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[MESSAGE_GetDataPInputParameters]]></bpws:from>
                                <bpws:to part="GetDataPInputParameters" variable="v_6fcc709d"/>
                            </bpws:copy>
                        </bpws:assign>
                    </bpws:sequence>
                </bpws:scope>
                <bpws:invoke inputVariable="v_6fcc709d"
                    name="_BX_invoke" operation="SearchData"
                    outputVariable="v_8ce957f3"
                    partnerLink="saveDataCaseSOAP_Consumer" portType="ns:saveDataCase"/>
                <bpws:assign name="_BX_assign_2" validate="no">
                    <bpws:copy
                        tibex:objectNamespace="http://com.tibco.poc.test.bw.saveDataCaseXSD"
                        tibex:tempVariable="MESSAGE_GetDataOutputParameters" tibex:transform="XmlToObject">
                        <bpws:from expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[$v_8ce957f3.GetDataOutputParameters]]></bpws:from>
                        <bpws:to variable="MESSAGE_GetDataOutputParameters"/>
                    </bpws:copy>
                    <bpws:copy ignoreMissingFromData="yes">
                        <bpws:from expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[		for (var iterator= MESSAGE_GetDataOutputParameters.searchDataResponse.listIterator(); iterator.hasNext(); ) {   				var responseline = iterator.next(); 				 var out_parameter_geschaeftsvorfall = com_example_arraymapping_Factory.createGS();					  out_parameter_geschaeftsvorfall.ahvNummer = responseline.AHVNummer;					  out_parameter_geschaeftsvorfall.dossierID = responseline.dossierID;					  out_parameter_geschaeftsvorfall.caseID = responseline.caseID;					  out_parameter_geschaeftsvorfall.dokumentenArt=responseline.dokumentenArt;					  out_parameter_geschaeftsvorfall.geschaeftsfall=responseline.geschaeftsfall;						 					  var count = MESSAGE_GetDataOutputParameters.searchDataResponse.size();					  Log.write("Count of array size of the return is :"+ count );					  Log.write("---------------------------------");					  Log.write("AHVNummer");	  			      Log.write("From Service received");			   		  Log.write(responseline.AHVNummer);					  Log.write("Mapped");			   		  Log.write(out_parameter_geschaeftsvorfall.ahvNummer);  			  		  Log.write("caseID");  			  		   Log.write("From Service received");			    	  Log.write(responseline.caseID);			    	   Log.write("Mapped");			    	  Log.write(out_parameter_geschaeftsvorfall.caseID);			          Log.write("dokumentenArt");			           Log.write("From Service received");			    	  Log.write(responseline.dokumentenArt);			    	   Log.write("Mapped");			    	  Log.write(out_parameter_geschaeftsvorfall.dokumentenArt);					  Log.write("geschaeftsfall");					   Log.write("From Service received");				      Log.write(responseline.geschaeftsfall);				       Log.write("Mapped");							      Log.write(out_parameter_geschaeftsvorfall.geschaeftsfall);				      Log.write("anzahl der dokumente");				       Log.write("From Service received");				      Log.write(responseline.anzahl_der_Dokumente);					       Log.write("Mapped");						      Log.write(out_parameter_geschaeftsvorfall.dossierID);				      Log.write("---------------------------------");				      out_parameter_geschaeftsvorfall;				         				      				      					  }		]]></bpws:from>
                        <bpws:to variable="GS_FOUND_BOM_SINGLE"/>
                    </bpws:copy>
                </bpws:assign>
            </bpws:sequence>
        </bpws:scope>
        <bpws:extensionActivity>
            <tibex:extActivity name="Eingabe"
                tibex:migrationAllowed="yes" tibex:type="userTask"
                tibex:xpdlId="_iF6eIAQ5Eem_G-97Kp4DSg" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="StartEvent to Eingabe"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="Eingabe to ServiceTask"/>
                </bpws:sources>
                <model:UserTaskDataModelType
                    distributionStrategy="OFFER" userTaskPriority="50"
                    workModelID="WM__iF6eIAQ5Eem_G-97Kp4DSg"
                    workModelVersionRange="[1.0.1.qualifier,1.0.1.qualifier]"
                    xmi:version="2.0"
                    xmlns:model="http://model.ut.n2.tibco.com" xmlns:xmi="http://www.omg.org/XMI">
                    <userTaskParticipants>
                        <userTaskParticipant entity="POSITION"
                            modelVersion="1" uniqueId="_o-TSQAQ5Eem_G-97Kp4DSg"/>
                    </userTaskParticipants>
                    <userTaskParameters>
                        <userTaskParameter mandatory="false" mode="OUT" name="GS"/>
                    </userTaskParameters>
                    <userTaskGroupMemberships/>
                </model:UserTaskDataModelType>
            </tibex:extActivity>
        </bpws:extensionActivity>
        <bpws:extensionActivity>
            <tibex:extActivity name="Ausgabe"
                tibex:migrationAllowed="yes" tibex:type="userTask"
                tibex:xpdlId="_ydtgFQRGEem_G-97Kp4DSg" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="ScriptTask to Ausgabe"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="Ausgabe to EndEvent"/>
                </bpws:sources>
                <model:UserTaskDataModelType
                    distributionStrategy="OFFER" userTaskPriority="50"
                    workModelID="WM__ydtgFQRGEem_G-97Kp4DSg"
                    workModelVersionRange="[1.0.1.qualifier,1.0.1.qualifier]"
                    xmi:version="2.0"
                    xmlns:model="http://model.ut.n2.tibco.com" xmlns:xmi="http://www.omg.org/XMI">
                    <userTaskParticipants>
                        <userTaskParticipant entity="POSITION"
                            modelVersion="1" uniqueId="_o-TSQAQ5Eem_G-97Kp4DSg"/>
                    </userTaskParticipants>
                    <userTaskParameters>
                        <userTaskParameter mandatory="false"
                            mode="INOUT" name="GS_FOUND_BOM"/>
                    </userTaskParameters>
                    <userTaskGroupMemberships/>
                </model:UserTaskDataModelType>
            </tibex:extActivity>
        </bpws:extensionActivity>
        <bpws:scope name="ServiceTask_2" tibex:migrationAllowed="yes"
            tibex:type="serviceTask" tibex:xpdlId="_36TNEQUhEem91O5jBpLYhA">
            <bpws:targets>
                <bpws:target linkName="ServiceTask to ServiceTask_2"/>
            </bpws:targets>
            <bpws:sources>
                <bpws:source linkName="ServiceTask_2 to ScriptTask"/>
            </bpws:sources>
            <bpws:variables>
                <bpws:variable messageType="ns:SearchDataRequest" name="v_6fcc709d"/>
                <bpws:variable messageType="ns:SearchDataResponse" name="v_8ce957f3"/>
            </bpws:variables>
            <bpws:sequence name="_BX_sequence_3">
                <bpws:scope name="_BX_ToSvcDataMapping_2">
                    <bpws:variables>
                        <bpws:variable
                            name="MESSAGE_GetDataPInputParameters" tibex:class="saveDataCaseXSD.bw.test.poc.tibco.com.SearchDataRequestType"/>
                    </bpws:variables>
                    <bpws:sequence name="_BX_sequence_4">
                        <bpws:extensionActivity>
                            <tibex:extActivity
                                name="_BX_DataMapperScript_2" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[// Create target 'GetDataPInputParameters' if it doesn't exist.
if (MESSAGE_GetDataPInputParameters == null) {
    MESSAGE_GetDataPInputParameters = saveDataCaseXSD_bw_test_poc_tibco_com_Factory.createSearchDataRequestType();
}

// Map from 'GS.ahvNummer' to 'GetDataPInputParameters.AHVNummer'
if (GS != null) {
    MESSAGE_GetDataPInputParameters.AHVNummer = GS.ahvNummer;
} else {
    MESSAGE_GetDataPInputParameters.AHVNummer = null;
}

// Map from 'GS.dokumentenArt' to 'GetDataPInputParameters.dokumentenArt'
if (GS != null) {
    MESSAGE_GetDataPInputParameters.dokumentenArt = GS.dokumentenArt;
} else {
    MESSAGE_GetDataPInputParameters.dokumentenArt = null;
}

// Map from 'GS.geschaeftsfall' to 'GetDataPInputParameters.geschaeftsfall'
if (GS != null) {
    MESSAGE_GetDataPInputParameters.geschaeftsfall = GS.geschaeftsfall;
} else {
    MESSAGE_GetDataPInputParameters.geschaeftsfall = null;
}


]]></tibex:script>
                            </tibex:extActivity>
                        </bpws:extensionActivity>
                        <bpws:assign name="_BX_assign_3" validate="no">
                            <bpws:copy
                                tibex:elementName="{http://com.tibco.poc.test.bw.saveDataCaseXSD}SearchDataRequest" tibex:transform="ObjectToXml">
                                <bpws:from expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[MESSAGE_GetDataPInputParameters]]></bpws:from>
                                <bpws:to part="GetDataPInputParameters" variable="v_6fcc709d"/>
                            </bpws:copy>
                        </bpws:assign>
                    </bpws:sequence>
                </bpws:scope>
                <bpws:invoke inputVariable="v_6fcc709d"
                    name="_BX_invoke_2" operation="SearchData"
                    outputVariable="v_8ce957f3"
                    partnerLink="saveDataCaseSOAP_Consumer" portType="ns:saveDataCase"/>
                <bpws:scope name="_BX_FromSvcDataMapping">
                    <bpws:variables>
                        <bpws:variable
                            name="MESSAGE_GetDataOutputParameters" tibex:class="saveDataCaseXSD.bw.test.poc.tibco.com.SearchDataResponsesType"/>
                    </bpws:variables>
                    <bpws:sequence name="_BX_sequence_5">
                        <bpws:assign name="_BX_assign_4" validate="no">
                            <bpws:copy
                                tibex:objectNamespace="http://com.tibco.poc.test.bw.saveDataCaseXSD" tibex:transform="XmlToObject">
                                <bpws:from expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[$v_8ce957f3.GetDataOutputParameters]]></bpws:from>
                                <bpws:to variable="MESSAGE_GetDataOutputParameters"/>
                            </bpws:copy>
                        </bpws:assign>
                        <bpws:extensionActivity>
                            <tibex:extActivity
                                name="_BX_DataMapperScript_3" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[// Create target 'temp_field' if it doesn't exist.
if (temp_field == null) {
    temp_field = saveDataCaseXSD_bw_test_poc_tibco_com_Factory.createSearchDataResponsesType();
}

// Map from 'GetDataOutputParameters.searchDataResponse' to 'temp_field.searchDataResponse'

// Overwrite list: temp_field.searchDataResponse
temp_field.searchDataResponse.clear();

if (MESSAGE_GetDataOutputParameters != null && MESSAGE_GetDataOutputParameters.searchDataResponse != null) {

    for (var i1 = 0; i1 < MESSAGE_GetDataOutputParameters.searchDataResponse.size(); i1++) { 
        var $sVi1 = ScriptUtil.copy(MESSAGE_GetDataOutputParameters.searchDataResponse.get(i1));
        
        temp_field.searchDataResponse.add($sVi1);
    }
}


]]></tibex:script>
                            </tibex:extActivity>
                        </bpws:extensionActivity>
                    </bpws:sequence>
                </bpws:scope>
            </bpws:sequence>
        </bpws:scope>
        <bpws:extensionActivity>
            <tibex:extActivity name="ScriptTask"
                tibex:migrationAllowed="yes" tibex:type="scriptTask"
                tibex:xpdlId="_IaM4kAUjEem91O5jBpLYhA" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="ServiceTask_2 to ScriptTask"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="ScriptTask to Ausgabe"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[for (var iterator= temp_field.searchDataResponse.listIterator(); iterator.hasNext(); ) {
	

   				var responseline = iterator.next();
				var targetline = com_example_arraymapping_Factory.createGS();
   					 
				targetline.ahvNummer = responseline.AHVNummer;
				targetline.dossierID = responseline.dossierID;
				targetline.caseID = responseline.caseID;
				targetline.dokumentenArt=responseline.dokumentenArt;
				targetline.geschaeftsfall=responseline.geschaeftsfall;	 				     			         				      
				
				GS_FOUND_BOM.add(targetline);
}

]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
    </bpws:flow>
</bpws:process>
