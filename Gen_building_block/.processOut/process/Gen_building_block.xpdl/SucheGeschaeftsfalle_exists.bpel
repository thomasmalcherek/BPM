<?xml version="1.0" encoding="UTF-8"?>
<bpws:process exitOnStandardFault="no"
    name="SucheGeschaeftsfalle_exists" suppressJoinFailure="yes"
    tibex:bxVersion="1.15.0" tibex:explicitCompensation="yes"
    tibex:xpdlId="_npPfIxM7EemnLOiGQkEvTQ"
    xmlns:bpws="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
    xmlns:jms="http://www.tibco.com/namespaces/ws/2004/soap/binding/JMS"
    xmlns:ns="http://com.tibco.poc.test.bw.saveDataCase"
    xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/"
    xmlns:tibex="http://www.tibco.com/bpel/2007/extensions"
    xmlns:tns="http://com.tibco.poc.test.bw.saveDataCase"
    xmlns:tns0="http://com.tibco.poc.test.bw.saveDataCaseXSD"
    xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <tibex:VariableDescriptor type="PersistentBatching">
        <task name="ScriptTaskMappingIntern">
            <startingVariables>
                <variable>temp_field</variable>
                <variable>GS_FOUND_BOM</variable>
            </startingVariables>
        </task>
        <task name="_BX_sequence_2">
            <startingVariables>
                <variable>AHVNummer</variable>
                <variable>Geschaeftsfall</variable>
                <variable>DokumentenArt</variable>
            </startingVariables>
        </task>
        <task name="ScripTaskMaapingExtern">
            <startingVariables>
                <variable>GS_FOUND_BOM</variable>
                <variable>Geschaeftsfall_found</variable>
            </startingVariables>
        </task>
    </tibex:VariableDescriptor>
    <bpws:documentation>*** Generated by TIBCO Business Studio.</bpws:documentation>
    <bpws:import importType="http://schemas.xmlsoap.org/wsdl/"
        location="saveDataCase_JMS.wsdl" namespace="http://com.tibco.poc.test.bw.saveDataCase"/>
    <bpws:partnerLinks>
        <bpws:partnerLink name="saveDataCaseSOAP_Consumer"
            partnerLinkType="ns:saveDataCase_PLT" partnerRole="saveDataCaseProvider"/>
    </bpws:partnerLinks>
    <bpws:variables>
        <bpws:variable name="AHVNummer" tibex:parameter="in"
            tibex:xpdlId="_npPfPBM7EemnLOiGQkEvTQ" type="xsd:string"/>
        <bpws:variable name="DokumentenArt" tibex:parameter="in"
            tibex:xpdlId="_V2CtsRM8EemnLOiGQkEvTQ" type="xsd:string"/>
        <bpws:variable name="Geschaeftsfall" tibex:parameter="in"
            tibex:xpdlId="_ZBNCIRM8EemnLOiGQkEvTQ" type="xsd:string"/>
        <bpws:variable name="Geschaeftsfall_found" tibex:array="yes"
            tibex:class="com.example.arraymapping.GS"
            tibex:parameter="out" tibex:xpdlId="_woA7YRM8EemnLOiGQkEvTQ"/>
        <bpws:variable name="GS_FOUND_BOM" tibex:array="yes"
            tibex:class="com.example.arraymapping.GS" tibex:xpdlId="_npPfPRM7EemnLOiGQkEvTQ"/>
        <bpws:variable name="temp_field"
            tibex:class="saveDataCaseXSD.bw.test.poc.tibco.com.SearchDataResponsesType" tibex:xpdlId="_npPfPhM7EemnLOiGQkEvTQ"/>
        <bpws:variable name="_BX_fanVariable" type="xsd:int">
            <bpws:from>
                <bpws:literal><![CDATA[0]]></bpws:literal>
            </bpws:from>
        </bpws:variable>
    </bpws:variables>
    <bpws:extensions>
        <bpws:extension mustUnderstand="yes" namespace="http://www.tibco.com/bpel/2007/extensions"/>
    </bpws:extensions>
    <bpws:eventHandlers/>
    <bpws:flow name="_BX_flow_7S6_ABQlEemj5-ScqcIGvQ">
        <bpws:links>
            <bpws:link name="ScripTaskMaapingExtern to EndEvent" tibex:xpdlId="_npPfOhM7EemnLOiGQkEvTQ"/>
            <bpws:link name="_BX_scope_ServiceTask_2 to EndEvent" tibex:xpdlId="_M3HyYBQiEemj5-ScqcIGvQ"/>
            <bpws:link name="StartEvent to _BX_scope_ServiceTask_2" tibex:xpdlId="_npPfNhM7EemnLOiGQkEvTQ"/>
            <bpws:link name="_BX_normalFlow to ScriptTaskMappingIntern" tibex:xpdlId="_npPfOxM7EemnLOiGQkEvTQ"/>
            <bpws:link
                name="ScriptTaskMappingIntern to ScripTaskMaapingExtern" tibex:xpdlId="_7HoU4RM8EemnLOiGQkEvTQ"/>
            <bpws:link name="ServiceTask_2 to _BX_normalFlow"/>
        </bpws:links>
        <bpws:extensionActivity>
            <tibex:receiveEvent createInstance="yes" eventTimeout="0"
                name="StartEvent" tibex:type="startEvent"
                tibex:xpdlId="_npPfJBM7EemnLOiGQkEvTQ" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:sources>
                    <bpws:source linkName="StartEvent to _BX_scope_ServiceTask_2"/>
                </bpws:sources>
                <tibex:parameters>
                    <parameterDescription mode="In" name="AHVNummer"/>
                    <parameterDescription mode="In" name="Geschaeftsfall"/>
                    <parameterDescription mode="In" name="DokumentenArt"/>
                    <parameterDescription mandatory="yes" mode="Out" name="Geschaeftsfall_found"/>
                </tibex:parameters>
                <tibex:eventSource>
                    <tibex:startEvent eventType="Default"/>
                </tibex:eventSource>
            </tibex:receiveEvent>
        </bpws:extensionActivity>
        <bpws:empty name="EndEvent" tibex:migrationAllowed="yes"
            tibex:type="endEvent" tibex:xpdlId="_npPfJRM7EemnLOiGQkEvTQ">
            <bpws:targets>
                <bpws:target linkName="ScripTaskMaapingExtern to EndEvent"/>
                <bpws:target linkName="_BX_scope_ServiceTask_2 to EndEvent"/>
            </bpws:targets>
        </bpws:empty>
        <bpws:extensionActivity>
            <tibex:extActivity name="ScriptTaskMappingIntern"
                tibex:migrationAllowed="yes" tibex:type="scriptTask"
                tibex:xpdlId="_npPfNRM7EemnLOiGQkEvTQ" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="_BX_normalFlow to ScriptTaskMappingIntern"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="ScriptTaskMappingIntern to ScripTaskMaapingExtern"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[for (var iterator=temp_field.searchDataResponse.listIterator(); iterator.hasNext(); ) {
	

   				var responseline = iterator.next();
				var targetline = com_example_arraymapping_Factory.createGS();
				
   					 
				targetline.ahvNummer = responseline.AHVNummer;
				targetline.dossierID = responseline.dossierID;
				targetline.caseID = responseline.caseID;
				targetline.dokumentenArt=responseline.dokumentenArt;
				targetline.geschaeftsfall=responseline.geschaeftsfall;	 				     			         				      
				
				GS_FOUND_BOM.add(targetline);
}

]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
        <bpws:extensionActivity>
            <tibex:extActivity name="ScripTaskMaapingExtern"
                tibex:migrationAllowed="yes" tibex:type="scriptTask"
                tibex:xpdlId="_7HoU4BM8EemnLOiGQkEvTQ" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="ScriptTaskMappingIntern to ScripTaskMaapingExtern"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="ScripTaskMaapingExtern to EndEvent"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[// Map from 'GS_FOUND_BOM' to 'Geschaeftsfall_found'

// Overwrite list: Geschaeftsfall_found
Geschaeftsfall_found.clear();

if (GS_FOUND_BOM != null) {

    for (var i1 = 0; i1 < GS_FOUND_BOM.size(); i1++) { 
        var $sVi1 = ScriptUtil.copy(GS_FOUND_BOM.get(i1));
        
        Geschaeftsfall_found.add($sVi1);
    }
}


]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
        <bpws:scope name="_BX_scope_ServiceTask_2" tibex:migrationAllowed="yes">
            <bpws:targets>
                <bpws:target linkName="StartEvent to _BX_scope_ServiceTask_2"/>
            </bpws:targets>
            <bpws:sources>
                <bpws:source linkName="_BX_scope_ServiceTask_2 to EndEvent">
                    <bpws:transitionCondition><![CDATA[$_BX_fanVariable=1]]></bpws:transitionCondition>
                </bpws:source>
            </bpws:sources>
            <bpws:eventHandlers>
                <bpws:onAlarm tibex:cancel="yes" tibex:deadline="yes">
                    <bpws:for expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA["PT2M"]]></bpws:for>
                    <bpws:scope name="_BX_scope__MGsbABQiEemj5-ScqcIGvQ">
                        <bpws:assign name="TimerEvent"
                            tibex:type="boundaryTimerEvent"
                            tibex:xpdlId="_MGsbABQiEemj5-ScqcIGvQ" validate="no">
                            <bpws:copy>
                                <bpws:from><![CDATA[1]]></bpws:from>
                                <bpws:to variable="_BX_fanVariable"/>
                            </bpws:copy>
                        </bpws:assign>
                    </bpws:scope>
                </bpws:onAlarm>
            </bpws:eventHandlers>
            <bpws:scope name="ServiceTask_2" tibex:type="serviceTask" tibex:xpdlId="_npPfMRM7EemnLOiGQkEvTQ">
                <bpws:targets/>
                <bpws:sources>
                    <bpws:source linkName="ServiceTask_2 to _BX_normalFlow">
                        <bpws:transitionCondition expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[_BX_fanVariable=0; true]]></bpws:transitionCondition>
                    </bpws:source>
                </bpws:sources>
                <bpws:variables>
                    <bpws:variable messageType="ns:SearchDataRequest" name="v_6fcc709d"/>
                    <bpws:variable messageType="ns:SearchDataResponse" name="v_8ce957f3"/>
                </bpws:variables>
                <bpws:sequence name="_BX_sequence">
                    <bpws:scope name="_BX_ToSvcDataMapping">
                        <bpws:variables>
                            <bpws:variable
                                name="MESSAGE_SearchDataInputParameters" tibex:class="saveDataCaseXSD.bw.test.poc.tibco.com.SearchDataRequestType"/>
                        </bpws:variables>
                        <bpws:sequence name="_BX_sequence_2">
                            <bpws:extensionActivity>
                                <tibex:extActivity
                                    name="_BX_DataMapperScript" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                                    <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[// Create target 'SearchDataInputParameters' if it doesn't exist.
if (MESSAGE_SearchDataInputParameters == null) {
    MESSAGE_SearchDataInputParameters = saveDataCaseXSD_bw_test_poc_tibco_com_Factory.createSearchDataRequestType();
}

// Map from 'AHVNummer' to 'SearchDataInputParameters.AHVNummer'
MESSAGE_SearchDataInputParameters.AHVNummer = AHVNummer;

// Map from 'DokumentenArt' to 'SearchDataInputParameters.dokumentenArt'
MESSAGE_SearchDataInputParameters.dokumentenArt = DokumentenArt;

// Map from 'Geschaeftsfall' to 'SearchDataInputParameters.geschaeftsfall'
MESSAGE_SearchDataInputParameters.geschaeftsfall = Geschaeftsfall;


]]></tibex:script>
                                </tibex:extActivity>
                            </bpws:extensionActivity>
                            <bpws:assign name="_BX_assign" validate="no">
                                <bpws:copy
                                    tibex:elementName="{http://com.tibco.poc.test.bw.saveDataCaseXSD}SearchDataRequest" tibex:transform="ObjectToXml">
                                    <bpws:from expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[MESSAGE_SearchDataInputParameters]]></bpws:from>
                                    <bpws:to
                                    part="SearchDataInputParameters" variable="v_6fcc709d"/>
                                </bpws:copy>
                            </bpws:assign>
                        </bpws:sequence>
                    </bpws:scope>
                    <bpws:invoke inputVariable="v_6fcc709d"
                        name="_BX_invoke" operation="SearchData"
                        outputVariable="v_8ce957f3"
                        partnerLink="saveDataCaseSOAP_Consumer" portType="ns:saveDataCase"/>
                    <bpws:scope name="_BX_FromSvcDataMapping">
                        <bpws:variables>
                            <bpws:variable
                                name="MESSAGE_SearchDataOutputParameters" tibex:class="saveDataCaseXSD.bw.test.poc.tibco.com.SearchDataResponsesType"/>
                        </bpws:variables>
                        <bpws:sequence name="_BX_sequence_3">
                            <bpws:assign name="_BX_assign_2" validate="no">
                                <bpws:copy
                                    tibex:objectNamespace="http://com.tibco.poc.test.bw.saveDataCaseXSD" tibex:transform="XmlToObject">
                                    <bpws:from expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[$v_8ce957f3.SearchDataOutputParameters]]></bpws:from>
                                    <bpws:to variable="MESSAGE_SearchDataOutputParameters"/>
                                </bpws:copy>
                            </bpws:assign>
                            <bpws:extensionActivity>
                                <tibex:extActivity
                                    name="_BX_DataMapperScript_2" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                                    <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[// Create target 'temp_field' if it doesn't exist.
if (temp_field == null) {
    temp_field = saveDataCaseXSD_bw_test_poc_tibco_com_Factory.createSearchDataResponsesType();
}

// Map from 'SearchDataOutputParameters.searchDataResponse' to 'temp_field.searchDataResponse'

// Overwrite list: temp_field.searchDataResponse
temp_field.searchDataResponse.clear();

if (MESSAGE_SearchDataOutputParameters != null && MESSAGE_SearchDataOutputParameters.searchDataResponse != null) {

    for (var i1 = 0; i1 < MESSAGE_SearchDataOutputParameters.searchDataResponse.size(); i1++) { 
        var $sVi1 = ScriptUtil.copy(MESSAGE_SearchDataOutputParameters.searchDataResponse.get(i1));
        
        temp_field.searchDataResponse.add($sVi1);
    }
}


]]></tibex:script>
                                </tibex:extActivity>
                            </bpws:extensionActivity>
                        </bpws:sequence>
                    </bpws:scope>
                </bpws:sequence>
            </bpws:scope>
        </bpws:scope>
        <bpws:empty name="_BX_normalFlow">
            <bpws:targets>
                <bpws:target linkName="ServiceTask_2 to _BX_normalFlow"/>
            </bpws:targets>
            <bpws:sources>
                <bpws:source linkName="_BX_normalFlow to ScriptTaskMappingIntern"/>
            </bpws:sources>
        </bpws:empty>
    </bpws:flow>
</bpws:process>
